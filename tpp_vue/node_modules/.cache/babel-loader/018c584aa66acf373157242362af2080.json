{"remainingRequest":"C:\\Users\\web\\Desktop\\tpp\\taopiaopiao\\tpp_vue\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\web\\Desktop\\tpp\\taopiaopiao\\tpp_vue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\web\\Desktop\\tpp\\taopiaopiao\\tpp_vue\\src\\views\\seat\\Seat.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\web\\Desktop\\tpp\\taopiaopiao\\tpp_vue\\src\\views\\seat\\Seat.vue","mtime":1567048094701},{"path":"C:\\Users\\web\\Desktop\\tpp\\taopiaopiao\\tpp_vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1534853416000},{"path":"C:\\Users\\web\\Desktop\\tpp\\taopiaopiao\\tpp_vue\\node_modules\\babel-loader\\lib\\index.js","mtime":1529635966000},{"path":"C:\\Users\\web\\Desktop\\tpp\\taopiaopiao\\tpp_vue\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  data: function data() {\n    return {\n      num: 0,\n      detail: [],\n      //保存了这部电影时间价格影院\n      cname: '',\n      id: [1, 3, 4, 6],\n      list: [],\n      //座位列表  这种形式  [ {i:7,j:3},{i:7,j:4} ]   全部的座位列表\n      soldList: [{\n        i: 8,\n        j: 5\n      }, {\n        i: 8,\n        j: 3\n      }, {\n        i: 8,\n        j: 4\n      }, {\n        i: 6,\n        j: 5\n      }, {\n        i: 7,\n        j: 3\n      }, {\n        i: 7,\n        j: 4\n      }] //已售位置\n\n    };\n  },\n  created: function created() {\n    this.load();\n    this.createList();\n  },\n  computed: {\n    cmid: function cmid() {\n      return this.$store.state.cmid;\n    },\n    //使用计算属性，计算出一个数组，里面包含了，choose==1的对象，可以（强行监听数组 list=[] 的变化）\n    buyList: function buyList() {\n      var list = [];\n\n      for (var j = 0; j < this.list.length; j++) {\n        for (var i = 0; i < this.list[j].length; i++) {\n          if (this.list[j][i].choose == 1) {\n            list[list.length] = this.list[j][i];\n          }\n        }\n      }\n\n      return list;\n    }\n  },\n  methods: {\n    toPayment: function toPayment() {\n      if (this.buyList.length > 0) {\n        // 路由传参对象，接受页面一刷新，数据就会变为\n        // {buyList: Array(4), detail: \"[object Object]\", cname: \"[object Object]\"}\n        var obj = {\n          buyList: this.buyList,\n          detail: this.detail,\n          cname: this.cname // console.log(obj);\n          // this.$router.push({\n          //   path:\"/payment\",\n          //   query:obj\n          // })      \n          //  vuex\n\n        };\n        this.$store.commit(\"changeSeatObj\", obj);\n        this.$router.push('/payment');\n      } else {\n        this.$toast({\n          message: \"请先选择座位\",\n          duration: 1000\n        });\n      }\n    },\n    //删除位置\n    del: function del(e) {\n      // console.log(e.currentTarget);\n      var el = e.currentTarget;\n      var j = el.dataset.j;\n      var i = el.dataset.i; //找到对应的元素 删除      \n\n      this.list[j][i].choose = 0;\n      this.num--;\n    },\n    //选座位\n    choose: function choose(e) {\n      var el = e.target;\n\n      if (el.nodeName == \"SPAN\") {\n        var s = el.dataset.show;\n\n        if (this.num >= 6) {\n          this.$toast({\n            message: \"最多可选6个座位\",\n            duration: 1000\n          });\n          return;\n        }\n\n        if (s != 0) {\n          //在s!=0 是操作\n          // var list=this.list;\n          var j = el.dataset.j;\n          var i = el.dataset.i;\n\n          if (el.dataset.choose == 0) {\n            //没有选中，让其选中\n            this.list[j][i].choose = 1;\n            this.num++;\n          } else {\n            //否则让其不选中\n            this.list[j][i].choose = 0;\n            this.num--;\n          }\n        }\n      }\n    },\n    //创建座位list，\n    createList: function createList() {\n      var soldList = this.soldList;\n      var list = [];\n\n      for (var a = 0; a < 9; a++) {\n        var li = [];\n\n        for (var b = 0; b < 14; b++) {\n          var num = 0;\n\n          for (var z = 0; z < soldList.length; z++) {\n            if (soldList[z].i == b && soldList[z].j == a) {\n              num++;\n            }\n          }\n\n          if (num > 0) {\n            var obj = {\n              i: b,\n              j: a,\n              show: 0,\n              choose: 0 //show:0 位置出售    \n\n            };\n          } else {\n            var obj = {\n              i: b,\n              j: a,\n              show: 1,\n              choose: 0 //show:1 位置未出售\n\n            };\n          }\n\n          li[b] = obj;\n        }\n\n        list[a] = li;\n      }\n\n      this.list = list;\n    },\n    //load\n    load: function load() {\n      var _this = this;\n\n      var url = \"cinema/v1/seat\";\n      var cmid = this.cmid;\n      var obj = {\n        cmid: cmid\n      };\n      this.axios.get(url, {\n        params: obj\n      }).then(function (res) {\n        if (res.data.code == 0) {\n          console.log(res.data.msg);\n        } else {\n          _this.detail = res.data.data.detail;\n          _this.cname = res.data.data.cname;\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["Seat.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDA,eAAA;AACA,MADA,kBACA;AACA,WAAA;AACA,WAAA,CADA;AAEA,cAAA,EAFA;AAEA;AACA,aAAA,EAHA;AAIA,UAAA,CAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAAA,CAAA,CAJA;AAKA,YAAA,EALA;AAKA;AACA,gBAAA,CAAA;AAAA,WAAA,CAAA;AAAA,WAAA;AAAA,OAAA,EAAA;AAAA,WAAA,CAAA;AAAA,WAAA;AAAA,OAAA,EAAA;AAAA,WAAA,CAAA;AAAA,WAAA;AAAA,OAAA,EAAA;AAAA,WAAA,CAAA;AAAA,WAAA;AAAA,OAAA,EAAA;AAAA,WAAA,CAAA;AAAA,WAAA;AAAA,OAAA,EAAA;AAAA,WAAA,CAAA;AAAA,WAAA;AAAA,OAAA,CANA,CAMA;;AANA,KAAA;AAQA,GAVA;AAWA,SAXA,qBAWA;AACA,SAAA,IAAA;AACA,SAAA,UAAA;AACA,GAdA;AAeA,YAAA;AACA,QADA,kBACA;AACA,aAAA,KAAA,MAAA,CAAA,KAAA,CAAA,IAAA;AACA,KAHA;AAIA;AACA,WALA,qBAKA;AACA,UAAA,OAAA,EAAA;;AACA,WAAA,IAAA,IAAA,CAAA,EAAA,IAAA,KAAA,IAAA,CAAA,MAAA,EAAA,GAAA,EAAA;AACA,aAAA,IAAA,IAAA,CAAA,EAAA,IAAA,KAAA,IAAA,CAAA,CAAA,EAAA,MAAA,EAAA,GAAA,EAAA;AACA,cAAA,KAAA,IAAA,CAAA,CAAA,EAAA,CAAA,EAAA,MAAA,IAAA,CAAA,EAAA;AACA,iBAAA,KAAA,MAAA,IAAA,KAAA,IAAA,CAAA,CAAA,EAAA,CAAA,CAAA;AACA;AACA;AACA;;AACA,aAAA,IAAA;AACA;AAfA,GAfA;AAgCA,WAAA;AACA,aADA,uBACA;AACA,UAAA,KAAA,OAAA,CAAA,MAAA,GAAA,CAAA,EAAA;AACA;AACA;AACA,YAAA,MAAA;AAAA,mBAAA,KAAA,OAAA;AAAA,kBAAA,KAAA,MAAA;AAAA,iBAAA,KAAA,KAAA,CACA;AACA;AACA;AACA;AACA;AACA;;AANA,SAAA;AAOA,aAAA,MAAA,CAAA,MAAA,CAAA,eAAA,EAAA,GAAA;AACA,aAAA,OAAA,CAAA,IAAA,CAAA,UAAA;AACA,OAZA,MAYA;AACA,aAAA,MAAA,CAAA;AACA,mBAAA,QADA;AAEA,oBAAA;AAFA,SAAA;AAIA;AAEA,KArBA;AAsBA;AACA,OAvBA,eAuBA,CAvBA,EAuBA;AACA;AACA,UAAA,KAAA,EAAA,aAAA;AACA,UAAA,IAAA,GAAA,OAAA,CAAA,CAAA;AACA,UAAA,IAAA,GAAA,OAAA,CAAA,CAAA,CAJA,CAKA;;AACA,WAAA,IAAA,CAAA,CAAA,EAAA,CAAA,EAAA,MAAA,GAAA,CAAA;AACA,WAAA,GAAA;AACA,KA/BA;AAgCA;AACA,UAjCA,kBAiCA,CAjCA,EAiCA;AACA,UAAA,KAAA,EAAA,MAAA;;AACA,UAAA,GAAA,QAAA,IAAA,MAAA,EAAA;AACA,YAAA,IAAA,GAAA,OAAA,CAAA,IAAA;;AACA,YAAA,KAAA,GAAA,IAAA,CAAA,EAAA;AACA,eAAA,MAAA,CAAA;AACA,qBAAA,UADA;AAEA,sBAAA;AAFA,WAAA;AAIA;AACA;;AACA,YAAA,KAAA,CAAA,EAAA;AAAA;AACA;AACA,cAAA,IAAA,GAAA,OAAA,CAAA,CAAA;AACA,cAAA,IAAA,GAAA,OAAA,CAAA,CAAA;;AACA,cAAA,GAAA,OAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AAAA;AACA,iBAAA,IAAA,CAAA,CAAA,EAAA,CAAA,EAAA,MAAA,GAAA,CAAA;AACA,iBAAA,GAAA;AACA,WAHA,MAGA;AAAA;AACA,iBAAA,IAAA,CAAA,CAAA,EAAA,CAAA,EAAA,MAAA,GAAA,CAAA;AACA,iBAAA,GAAA;AACA;AACA;AACA;AACA,KAzDA;AA0DA;AACA,cA3DA,wBA2DA;AACA,UAAA,WAAA,KAAA,QAAA;AACA,UAAA,OAAA,EAAA;;AACA,WAAA,IAAA,IAAA,CAAA,EAAA,IAAA,CAAA,EAAA,GAAA,EAAA;AACA,YAAA,KAAA,EAAA;;AACA,aAAA,IAAA,IAAA,CAAA,EAAA,IAAA,EAAA,EAAA,GAAA,EAAA;AACA,cAAA,MAAA,CAAA;;AACA,eAAA,IAAA,IAAA,CAAA,EAAA,IAAA,SAAA,MAAA,EAAA,GAAA,EAAA;AACA,gBAAA,SAAA,CAAA,EAAA,CAAA,IAAA,CAAA,IAAA,SAAA,CAAA,EAAA,CAAA,IAAA,CAAA,EAAA;AACA;AACA;AACA;;AACA,cAAA,MAAA,CAAA,EAAA;AACA,gBAAA,MAAA;AAAA,iBAAA,CAAA;AAAA,iBAAA,CAAA;AAAA,oBAAA,CAAA;AAAA,sBAAA,CAAA,CAAA;;AAAA,aAAA;AACA,WAFA,MAEA;AACA,gBAAA,MAAA;AAAA,iBAAA,CAAA;AAAA,iBAAA,CAAA;AAAA,oBAAA,CAAA;AAAA,sBAAA,CAAA,CAAA;;AAAA,aAAA;AACA;;AACA,aAAA,CAAA,IAAA,GAAA;AACA;;AACA,aAAA,CAAA,IAAA,EAAA;AACA;;AACA,WAAA,IAAA,GAAA,IAAA;AACA,KAjFA;AAkFA;AACA,QAnFA,kBAmFA;AAAA;;AACA,UAAA,MAAA,gBAAA;AACA,UAAA,OAAA,KAAA,IAAA;AACA,UAAA,MAAA;AAAA;AAAA,OAAA;AACA,WAAA,KAAA,CAAA,GAAA,CAAA,GAAA,EAAA;AAAA,gBAAA;AAAA,OAAA,EAAA,IAAA,CAAA,eAAA;AACA,YAAA,IAAA,IAAA,CAAA,IAAA,IAAA,CAAA,EAAA;AACA,kBAAA,GAAA,CAAA,IAAA,IAAA,CAAA,GAAA;AACA,SAFA,MAEA;AACA,gBAAA,MAAA,GAAA,IAAA,IAAA,CAAA,IAAA,CAAA,MAAA;AACA,gBAAA,KAAA,GAAA,IAAA,IAAA,CAAA,IAAA,CAAA,KAAA;AACA;AACA,OAPA;AAQA;AA/FA;AAhCA,CAAA","sourcesContent":["<template>\r\n  <div class=\"root\" id=\"seat\">\r\n    <div class=\"content\">\r\n      <div class=\"dy-list-item\">\r\n        <div class=\"cinema-info\">\r\n          <div class=\"dy-list-title\" v-cloak>{{detail.cname}}</div>\r\n          <div class=\"dy-list-brief\" v-cloak>今天 {{detail.time_start}}~{{detail.time_end}} ({{detail.d23}})</div>\r\n        </div>\r\n      </div>\r\n      <div id=\"J_xseat\">\r\n        <div class=\"seat-legend\">\r\n          <ul>\r\n            <li>\r\n              <i class=\"tpp-i i-normal core\"></i>可选\r\n            </li>\r\n            <li>\r\n              <i class=\"tpp-i i-sold core\"></i>已售\r\n            </li>\r\n            <li>\r\n              <i class=\"tpp-i i-best-area\"></i>最佳观影区\r\n            </li>\r\n          </ul>\r\n        </div>\r\n        <div class=\"hall-name\">\r\n          <p class=\"i-screen\">彩虹厅 银幕</p>\r\n        </div>\r\n      </div>\r\n      <div></div>\r\n    </div>\r\n    <div class=\"list_bg\">\r\n      <div class=\"seat_list\" @click=\"choose\">\r\n        <div class=\"row\" v-for=\"(item,index) of list\" :key=\"index\">\r\n          <div class=\"col\" v-for=\"(elem,index2) of item\" :key=\"index2\">\r\n            <!-- show==0 代表座位已经出售，显示为红色   -->\r\n            <span :data-j=\"elem.j\" :data-i=\"elem.i\" :data-show=\"elem.show\" :data-choose=\"elem.choose\" :class=\"{'is_show':elem.show==0,green:elem.choose==1}\"></span>          \r\n          </div>\r\n        </div>\r\n      </div>     \r\n    </div>\r\n    <div class=\"choose_main\">\r\n      <ul>\r\n        <li class=\"choose_item\" v-for=\"(elem,i) of buyList\" :data-j=\"elem.j\" :data-i=\"elem.i\" :key=\"i\" @click=\"del\">\r\n          <h3>{{elem.j+1}}排{{elem.i+1}}座</h3>\r\n          <h4>72.7元</h4>\r\n        </li>        \r\n      </ul>\r\n    </div>\r\n    <div class=\"jus\" :class=\"{show:buyList.length>0}\" @click=\"toPayment\">\r\n      <span class=\"tpp-btn\">请选座位</span>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  data(){\r\n    return {\r\n      num:0,\r\n      detail:[],     //保存了这部电影时间价格影院\r\n      cname:'',\r\n      id:[1,3,4,6],\r\n      list:[],      //座位列表  这种形式  [ {i:7,j:3},{i:7,j:4} ]   全部的座位列表\r\n      soldList:[ {i:8,j:5},{i:8,j:3},{i:8,j:4},{i:6,j:5},{i:7,j:3},{i:7,j:4} ],  //已售位置\r\n    }\r\n  },\r\n  created(){\r\n    this.load();\r\n    this.createList();\r\n  },\r\n  computed:{   \r\n    cmid(){\r\n      return this.$store.state.cmid;\r\n    },\r\n    //使用计算属性，计算出一个数组，里面包含了，choose==1的对象，可以（强行监听数组 list=[] 的变化）\r\n    buyList(){  \r\n      var list=[];\r\n      for(var j=0;j<this.list.length;j++){\r\n        for(var i=0;i<this.list[j].length;i++){\r\n          if(this.list[j][i].choose==1){\r\n            list[list.length]=this.list[j][i];\r\n          }\r\n        }\r\n      }\r\n      return list;\r\n    },\r\n  },  \r\n  methods:{\r\n    toPayment(){\r\n      if(this.buyList.length>0){\r\n          // 路由传参对象，接受页面一刷新，数据就会变为\r\n          // {buyList: Array(4), detail: \"[object Object]\", cname: \"[object Object]\"}\r\n          var obj={buyList:this.buyList,detail:this.detail,cname:this.cname}\r\n          // console.log(obj);\r\n          // this.$router.push({\r\n          //   path:\"/payment\",\r\n          //   query:obj\r\n          // })      \r\n        //  vuex\r\n        this.$store.commit(\"changeSeatObj\",obj);\r\n        this.$router.push('/payment')\r\n      }else{\r\n        this.$toast({\r\n          message:\"请先选择座位\",\r\n          duration:1000\r\n        })\r\n      }\r\n\r\n    },\r\n    //删除位置\r\n    del(e){ \r\n      // console.log(e.currentTarget);\r\n      var el=e.currentTarget;\r\n      var j=el.dataset.j;\r\n      var i=el.dataset.i;\r\n      //找到对应的元素 删除      \r\n      this.list[j][i].choose=0;\r\n      this.num--;\r\n    },\r\n    //选座位\r\n    choose(e){\r\n      var el=e.target;\r\n      if(el.nodeName==\"SPAN\"){ \r\n        var s=el.dataset.show;\r\n        if(this.num>=6){\r\n          this.$toast({\r\n            message:\"最多可选6个座位\",\r\n            duration:1000\r\n          })\r\n          return;\r\n        }\r\n        if(s!=0){         //在s!=0 是操作\r\n          // var list=this.list;\r\n          var j=el.dataset.j;\r\n          var i=el.dataset.i;      \r\n          if(el.dataset.choose==0){   //没有选中，让其选中\r\n            this.list[j][i].choose=1;  \r\n            this.num++;   \r\n          }else{                           //否则让其不选中\r\n            this.list[j][i].choose=0;\r\n            this.num--;\r\n          }      \r\n        }\r\n      } \r\n    },\r\n    //创建座位list，\r\n    createList(){\r\n      var soldList=this.soldList;\r\n      var list = [];\r\n      for(var a=0;a<9;a++){\r\n        var li=[]\r\n        for(var b=0;b<14;b++){\r\n          var num=0;\r\n          for(var z=0;z<soldList.length;z++){\r\n            if((soldList[z].i==b) && (soldList[z].j==a)){\r\n              num++;\r\n            }\r\n          }\r\n          if(num>0){\r\n            var obj={i:b,j:a,show:0,choose:0}  //show:0 位置出售    \r\n          }else{\r\n            var obj={i:b,j:a,show:1,choose:0}  //show:1 位置未出售\r\n          }\r\n          li[b]=obj;\r\n        }\r\n        list[a]=li;\r\n      }\r\n      this.list=list;\r\n    },\r\n    //load\r\n    load(){\r\n      var url=\"cinema/v1/seat\"\r\n      var cmid=this.cmid;\r\n      var obj={cmid};\r\n      this.axios.get(url,{params:obj}).then(res=>{\r\n        if(res.data.code==0){\r\n          console.log(res.data.msg)\r\n        }else{\r\n          this.detail=res.data.data.detail;\r\n          this.cname=res.data.data.cname;\r\n        }\r\n      })\r\n    },\r\n  }\r\n}\r\n</script>\r\n<style>\r\n    @import url(\"../../assets/css/seat.css\");\r\n</style>"],"sourceRoot":"src\\views\\seat"}]}